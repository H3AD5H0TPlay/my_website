---
import MobileMenu from '../components/MobileMenu.astro';
import LiquidGlassEffect from '../components/LiquidGlassEffect.astro';
import { translations } from '../utils/translations';

interface Props {
  title: string;
  description?: string;
}

const defaultDescription = "Peter Varga's Portfolio - Software Developer";

const { title, description = defaultDescription } = Astro.props;
---

<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <meta name="author" content="Peter Varga" />
    <meta name="keywords" content="software developer, web development, portfolio, Peter Varga, TypeScript, React, Node.js, full-stack" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/og-image.jpg" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="theme-color" content="#ff1744" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <meta name="robots" content="index, follow" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <title>{title}</title>
    <script src="../scripts/animations.js"></script>
    <style>
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(-20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      @keyframes rotateCornerDecoration {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      @keyframes glitch {
        0% {
          text-shadow: 0.05em 0 0 #ff0000, -0.05em -0.025em 0 #00ff00,
            -0.025em 0.05em 0 #0000ff;
        }
        14% {
          text-shadow: 0.05em 0 0 #ff0000, -0.05em -0.025em 0 #00ff00,
            -0.025em 0.05em 0 #0000ff;
        }
        15% {
          text-shadow: -0.05em -0.025em 0 #ff0000, 0.025em 0.025em 0 #00ff00,
            -0.05em -0.05em 0 #0000ff;
        }
        49% {
          text-shadow: -0.05em -0.025em 0 #ff0000, 0.025em 0.025em 0 #00ff00,
            -0.05em -0.05em 0 #0000ff;
        }
        50% {
          text-shadow: 0.025em 0.05em 0 #ff0000, 0.05em 0 0 #00ff00,
            0 -0.05em 0 #0000ff;
        }
        99% {
          text-shadow: 0.025em 0.05em 0 #ff0000, 0.05em 0 0 #00ff00,
            0 -0.05em 0 #0000ff;
        }
        100% {
          text-shadow: -0.025em 0 0 #ff0000, -0.025em -0.025em 0 #00ff00,
            -0.025em -0.05em 0 #0000ff;
        }
      }

      .cyber-box {
        position: relative;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
        border-radius: 0.75rem;
      }

      .cyber-box::before {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        width: 5rem;
        height: 5rem;
        border-top: 3px solid rgba(255, 23, 68, 0.4);
        border-right: 3px solid rgba(255, 23, 68, 0.4);
        border-top-right-radius: 0.75rem;
      }

      .cyber-box::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 5rem;
        height: 5rem;
        border-bottom: 3px solid rgba(255, 23, 68, 0.4);
        border-left: 3px solid rgba(255, 23, 68, 0.4);
        border-bottom-left-radius: 0.75rem;
      }

      .cyber-box .kanji-overlay {
        position: absolute;
        inset: 0;
        opacity: 0.03;
      }

      .cyber-box:hover::before,
      .cyber-box:hover::after {
        border-color: rgba(255, 23, 68, 0.6);
      }

      .glitch-hover:hover {
        animation: glitch 1s linear infinite;
      }

      @keyframes rotateBorder {
        0% {
          clip-path: polygon(0 0, 100% 0, 100% 3px, 3px 3px, 3px 100%, 0 100%);
        }
        25% {
          clip-path: polygon(0 0, 100% 0, 100% 100%, calc(100% - 3px) 100%, calc(100% - 3px) 3px, 0 3px);
        }
        50% {
          clip-path: polygon(0 calc(100% - 3px), calc(100% - 3px) calc(100% - 3px), calc(100% - 3px) 100%, 0 100%);
        }
        75% {
          clip-path: polygon(0 0, 3px 0, 3px calc(100% - 3px), 100% calc(100% - 3px), 100% 100%, 0 100%);
        }
        100% {
          clip-path: polygon(0 0, 100% 0, 100% 3px, 3px 3px, 3px 100%, 0 100%);
        }
      }

      .cyber-border {
        position: absolute;
        inset: 0;
        border: 3px solid rgba(255, 23, 68, 0.4);
        border-radius: inherit;
        animation: rotateBorder 4s linear infinite;
        pointer-events: none;
      }

      .japanese-pattern {
        background-image: 
          linear-gradient(45deg, #ff174410 25%, transparent 25%), 
          linear-gradient(-45deg, #ff174410 25%, transparent 25%),
          linear-gradient(45deg, transparent 75%, #ff174410 75%),
          linear-gradient(-45deg, transparent 75%, #ff174410 75%);
        background-size: 20px 20px;
        background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
      }
    </style>
    <style is:global>
      :root {
        --cyber-red: #ff1744;
        --cyber-red-bright: #ff4081;
        --cyber-black: #000000;
        --cyber-dark: #0a0a0a;
      }

      body {
        background-image: 
          radial-gradient(circle at 50% 50%, rgba(255, 23, 68, 0.1) 0%, transparent 50%),
          linear-gradient(0deg, rgba(0, 0, 0, 0.95) 0%, rgba(0, 0, 0, 0.98) 100%);
        background-attachment: fixed;
      }



      .kanji-overlay::before {
        content: '技術';
        position: absolute;
        font-size: 120px;
        opacity: 0.03;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        pointer-events: none;
      }
    </style>
  </head>
  <body class="bg-cyber-black text-white min-h-screen font-sans overflow-x-hidden">
    <LiquidGlassEffect />
    
    <nav class="fixed w-full bg-cyber-black/40 backdrop-blur-md z-50 py-4 border-b border-cyber-red/20">
      <div class="container mx-auto px-4 relative">
        <div class="flex justify-between items-center">
          <a href={import.meta.env.BASE_URL} class="text-xl font-cyber font-bold text-cyber-red hover:text-cyber-red-bright transition-colors animate-glow relative">
            <span class="relative z-10">PV</span>
            <div class="absolute inset-0 bg-cyber-red/10 blur-lg"></div>
          </a>
          <div class="hidden md:flex space-x-8 font-cyber">
            <a href="#about" class="hover:text-cyber-red transition-colors group relative">
              <span class="inline-block group-hover:animate-glitch relative z-10">About</span>
              <div class="absolute inset-0 bg-cyber-red/0 group-hover:bg-cyber-red/10 transition-colors duration-300 blur-lg"></div>
            </a>
            <a href="#experience" class="hover:text-cyber-red transition-colors group relative">
              <span class="inline-block group-hover:animate-glitch relative z-10">Experience</span>
              <div class="absolute inset-0 bg-cyber-red/0 group-hover:bg-cyber-red/10 transition-colors duration-300 blur-lg"></div>
            </a>
            <a href="#skills" class="hover:text-cyber-red transition-colors group relative">
              <span class="inline-block group-hover:animate-glitch relative z-10">Skills</span>
              <div class="absolute inset-0 bg-cyber-red/0 group-hover:bg-cyber-red/10 transition-colors duration-300 blur-lg"></div>
            </a>
            <a href="#projects" class="hover:text-cyber-red transition-colors group relative">
              <span class="inline-block group-hover:animate-glitch relative z-10">Projects</span>
              <div class="absolute inset-0 bg-cyber-red/0 group-hover:bg-cyber-red/10 transition-colors duration-300 blur-lg"></div>
            </a>
            <a href="#contact" class="hover:text-cyber-red transition-colors group relative">
              <span class="inline-block group-hover:animate-glitch relative z-10">Contact</span>
              <div class="absolute inset-0 bg-cyber-red/0 group-hover:bg-cyber-red/10 transition-colors duration-300 blur-lg"></div>
            </a>
          </div>
          <div class="flex items-center space-x-4">
            <!-- Mobile menu trigger is fixed; component moved outside header to avoid stacking issues -->
          </div>
        </div>
      </div>
    </nav>
    <!-- Render MobileMenu outside the header to ensure the fixed overlay isn't constrained by header backdrop/filters -->
    <MobileMenu />

    <main class="relative">
      <slot />
    </main>

    <footer class="bg-cyber-darker/50 backdrop-blur-sm border-t border-cyber-red/20 py-8 relative z-10">
      <div class="container mx-auto px-4 text-center font-cyber">
        <p class="text-cyber-red animate-flicker relative">
          <span class="relative z-10">&copy; {new Date().getFullYear()} Peter Varga. <span class="text-white/80">All rights reserved.</span></span>
          <div class="absolute inset-0 bg-cyber-red/5 blur-lg"></div>
        </p>
      </div>
    </footer>

    <script src="../scripts/smooth-scroll.ts"></script>
  </body>
</html>